<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pits n' Giggles</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=DS-Digital&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/weather.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tyreIcons.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/conditions.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/speedLimit.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
  </head>
  <body>
    <div class="dashboard-container">
      <header class="dashboard-header">
        <div class="track-info">
          <h1 class="track-name" id="track-name">PITS N' GIGGLES</h1>
          <div class="conditions">
            <div class="condition-item">
              <i class="fa-solid fa-road condition-icon"></i>
              <span id="track-temp" class="condition-value"></span>
            </div>
            <div class="condition-item">
              <i class="bi bi-thermometer-half condition-icon"></i>
              <span id="air-temp" class="condition-value"></span>
            </div>
            <div class="condition-item">
              <div id="pit-speed-limit" class="speed-limit-sign"></div>
            </div>
          </div>
        </div>
        <div class="fastest-lap">
          <span class="fastest-lap-label">FASTEST LAP</span>
          <span class="fastest-lap-time" id="fastestLapTimeSpan"></span>
          <span class="fastest-lap-driver" id="fastestLapNameSpan"></span>
        </div>
        <div class="header-right">
          <div id="weather-predictions" class="weather-forecast">
            <!-- Populated by JavaScript -->
          </div>
          <button id="race-stats-btn" class="settings-button">
            üèÅ
          </button>
          <button id="settings-btn" class="settings-button">
            <i class="bi bi-gear-fill"></i>
          </button>
        </div>
      </header>

      <!-- Main Container -->
      <main class="dashboard-main">
        <div class="telemetry-table-wrapper">
          <table class="telemetry-table" id="race-table">
            <thead>
              <tr>
                <th>POS</th>
                <th>DRIVER</th>
                <th id="delta-th" data-bs-toggle="tooltip" data-bs-title="TODO: enter tooltip">DELTA</th>
                <th>ERS</th>
                <th>WARNS/PENS</th>
                <th id="best-lap-th" class="best-lap" data-bs-toggle="tooltip" data-bs-title="Click to toggle between absolute and relative format">BEST LAP</th>
                <th id="last-lap-th" class="last-lap" data-bs-toggle="tooltip" data-bs-title="Click to toggle between absolute and relative format">LAST LAP</th>
                <th id="tyre-info-th" data-bs-toggle="tooltip" data-bs-title="Click to toggle between average and maximum format">TYRE INFO</th>
                <th id="wear-prediction-th">WEAR PREDICTION</th>
                <th>WING DAMAGE</th>
                <th>FUEL</th>
              </tr>
            </thead>
            <tbody id="telemetry-data">
              <!-- Populated by JavaScript -->
            </tbody>
          </table>
        </div>
      </main>
    </div>

    <!-- Driver Details Modal -->
    <div class="modal fade" id="driverModal" tabindex="-1" aria-labelledby="driverModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-fullscreen driver-modal-dialog">
        <div class="modal-content driver-modal-content">
          <div class="modal-header driver-modal-header d-flex justify-content-between align-items-center">
            <!-- Title and Navigation Buttons -->
            <div class="d-flex align-items-center">
              <h5 class="modal-title m-0" id="driverModalLabel">Driver Details</h5>
            </div>
            <!-- Refresh and Close Buttons -->
            <div>
              <button class="btn btn-sm btn-outline-primary me-2 p-1" id="refreshButtonDriver" title="Refresh">
                <i class="bi bi-arrow-clockwise"></i>
              </button>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
          </div>
          <div class="modal-body driver-modal-body">
            <!-- Nav tabs and tab content will be dynamically injected here by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal fade" id="settingsModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Pits n' Giggles Settings</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <!-- Number of cars to show -->
            <div class="mb-3">
              <label for="carsToShow" class="form-label">Number of cars to show (before/after player)</label>
              <input type="number" class="form-control" id="carsToShow" value="1" min="0" max="22">
            </div>
            <!-- Number of weather forecast samples to show -->
            <div class="mb-3">
              <label for="weatherSamplesToShow" class="form-label">Number of weather forecast samples to show</label>
              <input type="number" class="form-control" id="weatherSamplesToShow" value="3" min="1" max="5">
            </div>
            <!-- Team Name -->
            <div class="mb-3">
              <label for="teamName" class="form-label">My Team Name</label>
              <input type="text" class="form-control" id="teamNameInput" value="My Team">
            </div>
            <!-- Time format -->
            <div class="mb-3">
              <label class="form-label">Time Format</label>
              <div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" id="timeFormat12" name="timeFormat" value="12">
                  <label class="form-check-label" for="timeFormat12">12 Hour</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" id="timeFormat24" name="timeFormat" value="24" checked>
                  <label class="form-check-label" for="timeFormat24">24 Hour</label>
                </div>
              </div>
            </div>
            <!-- Last lap time format -->
            <div class="mb-3">
              <label class="form-label">Last Lap Time Format</label>
              <div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" id="lastLapAbsolute" name="lastLapTimeFormat" value="absolute" checked>
                  <label class="form-check-label" for="lastLapAbsolute">Absolute</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" id="lastLapRelative" name="lastLapTimeFormat" value="relative">
                  <label class="form-check-label" for="lastLapRelative">Relative</label>
                </div>
              </div>
            </div>
            <!-- Best lap time format -->
            <div class="mb-3">
              <label class="form-label">Best Lap Time Format</label>
              <div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" id="bestLapAbsolute" name="bestLapTimeFormat" value="absolute" checked>
                  <label class="form-check-label" for="bestLapAbsolute">Absolute</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" id="bestLapRelative" name="bestLapTimeFormat" value="relative">
                  <label class="form-check-label" for="bestLapRelative">Relative</label>
                </div>
              </div>
            </div>
            <!-- Tyre wear format -->
            <div class="mb-3">
              <label class="form-label">Delta Format (only for post race tool)</label>
              <div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" id="tyreWearAbsolute" name="tyreWearFormat" value="absolute" checked>
                  <label class="form-check-label" for="tyreWearAbsolute">Absolute</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" id="tyreWearRelative" name="tyreWearFormat" value="relative">
                  <label class="form-check-label" for="tyreWearRelative">Relative</label>
                </div>
              </div>
            </div>
            <!-- Delta format -->
            <div class="mb-3">
              <label class="form-label">Tyre Wear Format</label>
              <div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" id="deltaLeader" name="deltaFormat" value="absolute">
                  <label class="form-check-label" for="deltaLeader">Leader</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" id="deltaRelative" name="deltaFormat" value="relative" checked>
                  <label class="form-check-label" for="deltaRelative">Relative</label>
                </div>
              </div>
            </div>
            <!-- TTS voice -->
            <div class="mb-3">
              <label for="voiceSelect" class="form-label">Text to Speech Voice</label>
              <div class="input-group">
                <select id="voiceSelect" class="form-select">
                  <!-- Options will be populated via JavaScript -->
                </select>
                <button id="playSampleButton" class="btn btn-secondary" type="button">Play Sample</button>
              </div>
            </div>
            <!-- TTS Volume Level -->
            <div class="mb-3">
              <label for="volumeRange" class="form-label">TTS Volume Level</label>
              <div class="d-flex align-items-center">
                <input
                  type="range"
                  class="form-range me-3"
                  id="volumeRange"
                  min="0"
                  max="100"
                  step="1"
                  value="50"
                  aria-label="TTS Volume Level"
                >
                <span id="volumeLabel" class="fw-bold">50</span>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" id="saveSettings">Save changes</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Race Stats Modal -->
    <div class="modal fade" id="raceStatsModal" tabindex="-1" aria-labelledby="raceStatsModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-fullscreen race-stats-modal-dialog">
        <div class="modal-content race-stats-modal-content">
          <div class="modal-header race-stats-modal-header d-flex justify-content-between align-items-center">
            <!-- Title and Navigation Buttons -->
            <div class="d-flex align-items-center">
              <h5 class="modal-title m-0" id="raceStatsModalLabel">Race Stats</h5>
            </div>
            <!-- Refresh and Close Buttons -->
            <div>
              <button class="btn btn-sm btn-outline-primary me-2 p-1" id="refreshButtonRace" title="Refresh">
                <i class="bi bi-arrow-clockwise"></i>
              </button>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
          </div>
          <div class="modal-body race-stats-modal-body">
            <!-- Nav tabs and tab content will be dynamically injected here by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
      <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-body"></div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/preferences.js') }}"></script>
    <script src="{{ url_for('static', filename='js/utils.js') }}"></script>
    <script src="{{ url_for('static', filename='js/weatherUI.js') }}"></script>
    <script src="{{ url_for('static', filename='js/mockData.js') }}"></script>
    <script src="{{ url_for('static', filename='js/graph.js') }}"></script>
    <script src="{{ url_for('static', filename='js/driverDataModalPopulator.js') }}"></script>
    <script src="{{ url_for('static', filename='js/raceStatsModalPopulator.js') }}"></script>
    <script src="{{ url_for('static', filename='js/modals.js') }}"></script>
    <script src="{{ url_for('static', filename='js/raceTableRowPopulator.js') }}"></script>
    <script src="{{ url_for('static', filename='js/telemetryRenderer.js') }}"></script>
    <script src="{{ url_for('static', filename='js/frontendUpdate.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
  </body>
</html>